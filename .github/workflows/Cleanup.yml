name: Cleanup

on:
  repository_dispatch:
    types: [Cleanup-Artifacts]
  workflow_dispatch:

jobs:
  main:
    runs-on: ubuntu-latest

    steps:
      - name: Delete artifacts
        if: github.client_payload.event_type == 'delete_all_artifacts'
        uses: christian-korneck/delete-run-artifacts-action@v1
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with: 
          parent_runid: ${{ github.client_payload.parent_data.parent_runid }}
          parent_repo: ${{ github.client_payload.parent_data.parent_repo }}
